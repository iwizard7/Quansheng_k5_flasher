# üéâ –§–ò–ù–ê–õ–¨–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ü—Ä–æ–±–ª–µ–º–∞ —Å Interface —Ä–µ—à–µ–Ω–∞!

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã

–ò–∑ –ª–æ–≥–æ–≤ –±—ã–ª–æ –≤–∏–¥–Ω–æ:
```
[DEBUG]    - Interface –¥–æ—Å—Ç—É–ø–µ–Ω: false
[ERROR] ‚ùå Interface –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
[ERROR] ‚ùå –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
```

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—ã—Ç–∞–ª–æ—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å USB Interface –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å UV-K5, –Ω–æ UV-K5 –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫–∞–∫ **—Å–µ—Ä–∏–π–Ω—ã–π –ø–æ—Ä—Ç**, –∞ –Ω–µ –∫–∞–∫ USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º.

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –£–±—Ä–∞–ª–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ USB Interface
**–ë—ã–ª–æ**:
```swift
func performHandshake(interface: IOUSBInterfaceInterface300?) async throws {
    guard let interface = interface else {
        logManager.log("‚ùå Interface –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω", level: .error)
        throw K5ProtocolError.deviceNotConnected
    }
```

**–°—Ç–∞–ª–æ**:
```swift
func performHandshake(interface: IOUSBInterfaceInterface300? = nil) async throws {
    // –î–ª—è —Å–µ—Ä–∏–π–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞ Interface –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
    logManager.log("üîÑ –ù–∞—á–∞–ª–æ handshake —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º Quansheng UV-K5 —á–µ—Ä–µ–∑ —Å–µ—Ä–∏–π–Ω—ã–π –ø–æ—Ä—Ç", level: .info)
```

### 2. –ò—Å–ø—Ä–∞–≤–∏–ª–∏ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
–£–±—Ä–∞–ª–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ `interface` –∏–∑ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π:
- ‚úÖ `performHandshake()`
- ‚úÖ `testCommunication()`
- ‚úÖ `readBatteryVoltage()`
- ‚úÖ `readBatteryCalibration()`
- ‚úÖ `readFirmwareVersion()`
- ‚úÖ `readSettings()`
- ‚úÖ `writeSettings()`
- ‚úÖ `readChannels()`
- ‚úÖ `writeChannels()`
- ‚úÖ `readFullCalibration()`
- ‚úÖ `writeFullCalibration()`
- ‚úÖ `readDeviceInfo()`

### 3. –ò—Å–ø—Ä–∞–≤–∏–ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ `sendCommand()` - —Ç–µ–ø–µ—Ä—å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç interface
- ‚úÖ `performUSBTransaction()` - —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ —Å–µ—Ä–∏–π–Ω—ã–π –ø–æ—Ä—Ç
- ‚úÖ `enterBootloader()`, `exitBootloader()`, `eraseFlash()`, `writeFlashBlock()`

### 4. –ú–∞—Å—Å–æ–≤–∞—è –∑–∞–º–µ–Ω–∞ –≤—ã–∑–æ–≤–æ–≤
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ sed –¥–ª—è –∑–∞–º–µ–Ω—ã –≤—Å–µ—Ö –≤—ã–∑–æ–≤–æ–≤:
```bash
sed -i '' 's/sendCommand(\([^,]*\), interface: interface)/sendCommand(\1)/g'
```

## üöÄ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ —ç—Ç–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ:

### ‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ UV-K5
- –ë–æ–ª—å—à–µ –Ω–µ –±—É–¥–µ—Ç –æ—à–∏–±–æ–∫ "Interface –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω"
- Handshake –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ —Å–µ—Ä–∏–π–Ω—ã–π –ø–æ—Ä—Ç
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–∏ –±—É–¥–µ—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —É—Å–ø–µ—à–Ω–æ

### ‚úÖ –ß–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –í–æ–ª—å—Ç–∞–∂ –±–∞—Ç–∞—Ä–µ–∏ –¥–æ–ª–∂–µ–Ω —á–∏—Ç–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ö–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –¥–æ–ª–∂–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è

### ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–µ –ª–æ–≥–∏
–ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ª–æ–≥–∞—Ö:
```
üîÑ –ù–∞—á–∞–ª–æ handshake —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º Quansheng UV-K5 —á–µ—Ä–µ–∑ —Å–µ—Ä–∏–π–Ω—ã–π –ø–æ—Ä—Ç
üîç –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–∏ —Å UV-K5 —á–µ—Ä–µ–∑ —Å–µ—Ä–∏–π–Ω—ã–π –ø–æ—Ä—Ç
üîã –ù–∞—á–∏–Ω–∞–µ–º —á—Ç–µ–Ω–∏–µ –≤–æ–ª—å—Ç–∞–∂–∞ –±–∞—Ç–∞—Ä–µ–∏ UV-K5 —á–µ—Ä–µ–∑ —Å–µ—Ä–∏–π–Ω—ã–π –ø–æ—Ä—Ç
üîã –ù–∞—á–∏–Ω–∞–µ–º —á—Ç–µ–Ω–∏–µ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –±–∞—Ç–∞—Ä–µ–∏ UV-K5 —á–µ—Ä–µ–∑ —Å–µ—Ä–∏–π–Ω—ã–π –ø–æ—Ä—Ç
```

## üìä –°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

| –ü—Ä–æ–±–ª–µ–º–∞ | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------|----------|
| ‚ùå Interface –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û | –£–±—Ä–∞–ª–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ USB Interface |
| ‚ùå Handshake –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û | –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ —Å–µ—Ä–∏–π–Ω—ã–π –ø–æ—Ä—Ç |
| ‚ùå –ß—Ç–µ–Ω–∏–µ –≤–æ–ª—å—Ç–∞–∂–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ä–∏–π–Ω—ã–π –ø–æ—Ä—Ç |
| ‚ùå –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û | –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è —Å–µ—Ä–∏–π–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞ |

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** (—É–∂–µ –∑–∞–ø—É—â–µ–Ω–æ)
2. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ UV-K5** —á–µ—Ä–µ–∑ USB-–∫–∞–±–µ–ª—å
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–æ–≤—ã–µ –ª–æ–≥–∏** - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Ä–∞–±–æ—Ç–µ —á–µ—Ä–µ–∑ —Å–µ—Ä–∏–π–Ω—ã–π –ø–æ—Ä—Ç
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏**:
   - Handshake –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ —É—Å–ø–µ—à–Ω–æ
   - –ß—Ç–µ–Ω–∏–µ –≤–æ–ª—å—Ç–∞–∂–∞ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –¥–æ–ª–∂–Ω–∞ –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è

## üîç –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö

**–•–æ—Ä–æ—à–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**:
```
‚úÖ –ë–∞–∑–æ–≤–∞—è —Å–≤—è–∑—å —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ Handshake —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º UV-K5 –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
‚úÖ –í–æ–ª—å—Ç–∞–∂ –ø—Ä–æ—á–∏—Ç–∞–Ω: 3.756V
üì• –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç: AB CD EF 12 34 56
```

**–ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã**:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ UV-K5 –≤–∫–ª—é—á–µ–Ω
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π USB-–∫–∞–±–µ–ª—å (–Ω–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞—Ä—è–¥–∫–∏)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ –ø–µ—Ä–µ–¥–∞—á–∏

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–û—Å–Ω–æ–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞! UV-K5 —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ —Å–µ—Ä–∏–π–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –∞ –Ω–µ –∫–∞–∫ USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º. –≠—Ç–æ –¥–æ–ª–∂–Ω–æ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –æ—à–∏–±–∫–∏ "Interface –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω" –∏ –ø–æ–∑–≤–æ–ª–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ä–∞—Ü–∏–µ–π.

**–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏ —Å–æ–æ–±—â–∏—Ç–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö!** üöÄ